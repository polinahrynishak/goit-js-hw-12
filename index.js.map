{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport const getImagesByQuery = async (q, page) => {\n  try {\n    const requestParams = new URLSearchParams({\n      q: q,\n      key: '53365400-7139be9e5523c93bff54612dc',\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n      page: page,\n      per_page: 15,\n    });\n\n    const response = await axios.get(\n      `https://pixabay.com/api/?${requestParams}`\n    );\n    return response.data;\n  } catch (error) {\n    console.log('Помилка', error);\n  }\n};\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nexport const lightbox = new SimpleLightbox('.gallery a');\n\nexport const createGalleryCardTemplate = images => {\n  return `<li class=\"gallery-card\">\n  <a class=\"img-link\" href=\"${images.largeImageURL}\">           <img class=\"img\" src=\"${images.webformatURL}\" alt=\"${images.tags}\"title=\"${images.tags}\"/></a>\n  <div class=\"gallery-info\">\n  <p class=\"info-item\">Likes <span>${images.likes}</span></p>\n  <p class=\"info-item\">Views <span>${images.views}</span></p>          \n  <p class=\"info-item\">Comments <span>${images.comments}</span></p>\n  <p class=\"info-item\">Downloads <span>${images.downloads}</span></p>\n  </div>\n  </li>`;\n};\n\nexport function createGallery(images, galleryEl) {\n  const markup = images.map(image => createGalleryCardTemplate(image)).join('');\n  galleryEl.innerHTML = markup;\n  lightbox.refresh();\n}\n\nexport function appendToGallery(images, galleryEl) {\n  const markup = images.map(createGalleryCardTemplate).join('');\n  galleryEl.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n}\n\nexport function clearGallery(galleryEl) {\n  galleryEl.innerHTML = '';\n}\n\nexport function showLoader(loaderEl) {\n  loaderEl.classList.remove('hidden');\n}\n\nexport function hideLoader(loaderEl) {\n  loaderEl.classList.add('hidden');\n}\n\nexport function showLoadMoreButton(loadmoreBtn) {\n  loadmoreBtn.classList.remove('hidden');\n}\n\nexport function hideLoadMoreButton(loadmoreBtn) {\n  loadmoreBtn.classList.add('hidden');\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { getImagesByQuery } from './js/pixabay-api';\nimport {\n  createGallery,\n  appendToGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n} from './js/render-functions';\n\nexport const refs = {\n  searchForm: document.querySelector('.form'),\n  gallery: document.querySelector('.gallery'),\n  loader: document.querySelector('.loader'),\n  loadmoreBtn: document.querySelector('.loadmore-btn'),\n};\n\nlet page = 1;\nlet q = null;\nlet galleryCardHeight = null;\n\nconst onSearchFormSubmit = async event => {\n  try {\n    event.preventDefault();\n\n    const { target: searchForm } = event;\n    q = searchForm.elements['search-text'].value.trim();\n\n    if (q === '') {\n      iziToast.error({\n        message: 'Please fill in the search field',\n      });\n\n      return;\n    }\n\n    clearGallery(refs.gallery);\n    showLoader(refs.loader);\n    hideLoadMoreButton(refs.loadmoreBtn);\n    page = 1;\n\n    const data = await getImagesByQuery(q, page);\n    const images = data.hits;\n\n    if (images.length === 0) {\n      iziToast.info({\n        message: 'Sorry, no images found. Try again!',\n        position: 'topRight',\n        messageColor: '#fafafb',\n        backgroundColor: 'red',\n      });\n      return;\n    }\n\n    const totalPages = Math.ceil(data.totalHits / 15);\n\n    if (totalPages > 1) {\n      showLoadMoreButton(refs.loadmoreBtn);\n      refs.loadmoreBtn.addEventListener('click', onLoadmoreBtnClick);\n    }\n\n    createGallery(images, refs.gallery);\n\n    galleryCardHeight = refs.gallery\n      .querySelector('li')\n      .getBoundingClientRect().height;\n\n    showLoadMoreButton(refs.loadmoreBtn);\n\n    searchForm.elements['search-text'].value = '';\n  } catch (error) {\n    iziToast.error({\n      message: 'Something went wrong',\n      position: 'topRight',\n      backgroundColor: 'red',\n    });\n    console.log(error);\n  } finally {\n    hideLoader(refs.loader);\n  }\n};\n\nconst onLoadmoreBtnClick = async event => {\n  try {\n    page++;\n    showLoader(refs.loader);\n\n    const data = await getImagesByQuery(q, page);\n    const images = data.hits;\n\n    appendToGallery(images, refs.gallery);\n\n    scrollBy({\n      top: galleryCardHeight * 2,\n      behavior: 'smooth',\n    });\n\n    const totalPages = Math.ceil(data.totalHits / 15);\n\n    if (page >= totalPages) {\n      hideLoadMoreButton(refs.loadmoreBtn);\n      refs.loadmoreBtn.removeEventListener('click', onLoadmoreBtnClick);\n      iziToast.error({\n        message:\n          'We are sorry, but you have reached the end of search results.',\n        position: 'topRight',\n        backgroundColor: 'green',\n      });\n    }\n  } catch (error) {\n    console.log(error);\n  } finally {\n    hideLoader(refs.loader);\n  }\n};\n\nrefs.searchForm.addEventListener('submit', onSearchFormSubmit);\n"],"names":["getImagesByQuery","q","page","requestParams","axios","error","lightbox","SimpleLightbox","createGalleryCardTemplate","images","createGallery","galleryEl","markup","image","appendToGallery","clearGallery","showLoader","loaderEl","hideLoader","showLoadMoreButton","loadmoreBtn","hideLoadMoreButton","refs","galleryCardHeight","onSearchFormSubmit","event","searchForm","iziToast","data","onLoadmoreBtnClick","totalPages"],"mappings":"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"}