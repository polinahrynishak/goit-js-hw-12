{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nexport const getImagesByQuery = async (q, page) => {\n  try {\n    const requestParams = new URLSearchParams({\n      q: q,\n      key: '53365400-7139be9e5523c93bff54612dc',\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: 'true',\n      page: page,\n      per_page: 15,\n    });\n\n    const response = await axios.get(\n      `https://pixabay.com/api/?${requestParams}`\n    );\n    return response.data;\n  } catch (error) {\n    console.log('Помилка', error);\n  }\n};\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet lightbox = null;\n\nfunction initOrRefreshLightbox() {\n  if (!lightbox) {\n    lightbox = new SimpleLightbox('.gallery a');\n  } else {\n    lightbox.refresh();\n  }\n}\n\nexport const createGalleryCardTemplate = images => {\n  return `<li class=\"gallery-card\">\n  <a class=\"img-link\" href=\"${images.largeImageURL}\">           <img class=\"img\" src=\"${images.webformatURL}\" alt=\"${images.tags}\"title=\"${images.tags}\"/></a>\n  <div class=\"gallery-info\">\n  <p class=\"info-item\">Likes <span>${images.likes}</span></p>\n  <p class=\"info-item\">Views <span>${images.views}</span></p>          \n  <p class=\"info-item\">Comments <span>${images.comments}</span></p>\n  <p class=\"info-item\">Downloads <span>${images.downloads}</span></p>\n  </div>\n  </li>`;\n};\n\nexport function createGallery(images, galleryEl) {\n  const markup = images.map(image => createGalleryCardTemplate(image)).join('');\n  galleryEl.innerHTML = markup;\n  initOrRefreshLightbox();\n}\n\nexport function appendToGallery(images, galleryEl) {\n  const markup = images.map(createGalleryCardTemplate).join('');\n  galleryEl.insertAdjacentHTML('beforeend', markup);\n  initOrRefreshLightbox();\n}\n\nexport function clearGallery(galleryEl) {\n  galleryEl.innerHTML = '';\n}\n\nexport function showLoader(loaderEl) {\n  loaderEl.classList.remove('hidden');\n}\n\nexport function hideLoader(loaderEl) {\n  loaderEl.classList.add('hidden');\n}\n\nexport function showLoadMoreButton(loadmoreBtn) {\n  loadmoreBtn.classList.remove('hidden');\n}\n\nexport function hideLoadMoreButton(loadmoreBtn) {\n  loadmoreBtn.classList.add('hidden');\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { getImagesByQuery } from './js/pixabay-api';\nimport {\n  createGallery,\n  appendToGallery,\n  clearGallery,\n  showLoader,\n  hideLoader,\n  showLoadMoreButton,\n  hideLoadMoreButton,\n} from './js/render-functions';\n\nexport const refs = {\n  searchForm: document.querySelector('.form'),\n  gallery: document.querySelector('.gallery'),\n  loader: document.querySelector('.loader'),\n  loadmoreBtn: document.querySelector('.loadmore-btn'),\n};\n\nconst PER_PAGE = 15;\n\nlet page = 1;\nlet q = null;\nlet galleryCardHeight = null;\n\nconst onSearchFormSubmit = async event => {\n  try {\n    event.preventDefault();\n\n    const { target: searchForm } = event;\n    q = searchForm.elements['search-text'].value.trim();\n\n    if (q === '') {\n      iziToast.error({\n        message: 'Please fill in the search field',\n      });\n\n      return;\n    }\n\n    clearGallery(refs.gallery);\n    showLoader(refs.loader);\n    hideLoadMoreButton(refs.loadmoreBtn);\n    page = 1;\n\n    const data = await getImagesByQuery(q, page);\n    const images = data.hits;\n\n    if (images.length === 0) {\n      iziToast.info({\n        message: 'Sorry, no images found. Try again!',\n        position: 'topRight',\n        messageColor: '#fafafb',\n        backgroundColor: 'red',\n      });\n      return;\n    }\n\n    const totalPages = Math.ceil(data.totalHits / PER_PAGE);\n\n    createGallery(images, refs.gallery);\n\n    galleryCardHeight = refs.gallery\n      .querySelector('li')\n      .getBoundingClientRect().height;\n\n    if (totalPages > 1) {\n      showLoadMoreButton(refs.loadmoreBtn);\n    }\n\n    searchForm.elements['search-text'].value = '';\n  } catch (error) {\n    iziToast.error({\n      message: 'Something went wrong',\n      position: 'topRight',\n      backgroundColor: 'red',\n    });\n  } finally {\n    hideLoader(refs.loader);\n  }\n};\n\nconst onLoadmoreBtnClick = async event => {\n  try {\n    page++;\n    hideLoadMoreButton(refs.loadmoreBtn);\n    showLoader(refs.loader);\n\n    const data = await getImagesByQuery(q, page);\n    const images = data.hits;\n\n    if (images.length > 0) {\n      appendToGallery(images, refs.gallery);\n\n      scrollBy({\n        top: galleryCardHeight * 2,\n        behavior: 'smooth',\n      });\n\n      const totalPages = Math.ceil(data.totalHits / PER_PAGE);\n\n      if (page < totalPages) {\n        showLoadMoreButton(refs.loadmoreBtn);\n      } else {\n        iziToast.info({\n          message:\n            'We are sorry, but you have reached the end of search results.',\n          position: 'topRight',\n          backgroundColor: 'green',\n        });\n      }\n    }\n  } catch (error) {\n    console.log(error);\n  } finally {\n    hideLoader(refs.loader);\n  }\n};\n\nrefs.searchForm.addEventListener('submit', onSearchFormSubmit);\nrefs.loadmoreBtn.addEventListener('click', onLoadmoreBtnClick);\n"],"names":["getImagesByQuery","q","page","requestParams","axios","error","lightbox","initOrRefreshLightbox","SimpleLightbox","createGalleryCardTemplate","images","createGallery","galleryEl","markup","image","appendToGallery","clearGallery","showLoader","loaderEl","hideLoader","showLoadMoreButton","loadmoreBtn","hideLoadMoreButton","refs","PER_PAGE","galleryCardHeight","onSearchFormSubmit","event","searchForm","iziToast","data","totalPages","onLoadmoreBtnClick"],"mappings":"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"}